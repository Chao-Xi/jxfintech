
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Jacob's Fintech 基础教程">
      
      
        <meta name="author" content="Jacob Xi">
      
      
      
        <link rel="prev" href="../../agile/3agile_action/">
      
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>1 在 Kubernetes上免费部署Ollama+DeepSeek - Jacob Fintech Book</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetesollamadeepseek" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Jacob Fintech Book" class="md-header__button md-logo" aria-label="Jacob Fintech Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jacob Fintech Book
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1 在 Kubernetes上免费部署Ollama+DeepSeek
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chao-Xi/jxfintechbook.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jxfintechbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jacob Fintech Book" class="md-nav__button md-logo" aria-label="Jacob Fintech Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Jacob Fintech Book
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chao-Xi/jxfintechbook.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jxfintechbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    云原生架构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            云原生架构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../arch1/1Gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 云原生网关
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    区块链技术
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            区块链技术
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1blockchain/1theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 区块链的革命性及技术概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1blockchain/2techs_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 区块链技术细节（哈希算法/加密和挖矿)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1blockchain/3decentralised/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 区块链技术去中心化的共识机制
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1blockchain/4contract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 区块链技术智能合约
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1blockchain/5fintech/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 区块链技术传统金融和虚拟货币
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Autosys CA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Autosys CA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/1Autosys_tot1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 Autosys Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/2Autosys_jil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 Autosys JIL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/3Autosys_comp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 Autosys Components, Configuration & Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/4Autosys_cmd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 Austosys command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/5Autosys_job_cmd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 Manage Job in the Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/6autosys_vir_resouce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6 Autotsys virtual resource management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autosys/7autosys_shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7 Shell Script to check Autosys agent installed
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Agile fundamental
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Agile fundamental
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agile/1agile_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 Agile Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agile/2agile_block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 Agile Block Learn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agile/3agile_action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 Agile Action
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deepseek
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deepseek
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    1 在 Kubernetes上免费部署Ollama+DeepSeek
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    1 在 Kubernetes上免费部署Ollama+DeepSeek
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ollama-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Ollama 和 Kubernetes 的结合优势
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ollama-deepseek" class="md-nav__link">
    <span class="md-ellipsis">
      部署Ollama+ DeepSeek详细步骤：
    </span>
  </a>
  
    <nav class="md-nav" aria-label="部署Ollama+ DeepSeek详细步骤：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ollama-api" class="md-nav__link">
    <span class="md-ellipsis">
      暴露 Ollama API 服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ollama-deepseek_1" class="md-nav__link">
    <span class="md-ellipsis">
      与 Ollama + Deepseek 交互：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ollama-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Ollama 和 Kubernetes 的结合优势
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ollama-deepseek" class="md-nav__link">
    <span class="md-ellipsis">
      部署Ollama+ DeepSeek详细步骤：
    </span>
  </a>
  
    <nav class="md-nav" aria-label="部署Ollama+ DeepSeek详细步骤：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ollama-api" class="md-nav__link">
    <span class="md-ellipsis">
      暴露 Ollama API 服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ollama-deepseek_1" class="md-nav__link">
    <span class="md-ellipsis">
      与 Ollama + Deepseek 交互：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="kubernetesollamadeepseek">在 Kubernetes上免费部署Ollama+DeepSeek</h1>
<h2 id="ollama-kubernetes">Ollama 和 Kubernetes 的结合优势</h2>
<p>二者结合后，我们可以快速部署 Ollama 服务器，并通过 API 与 DeepSeek 模型进行交互。</p>
<p><strong>Ollama ：通过 REST API 简化了模型服务的部署和调用，支持多种机器学习模型。</strong></p>
<p><strong>Kubernetes ：提供灵活的扩展性和高可用性，适合部署复杂的模型服务。</strong></p>
<p><img alt="Alt Image Text" src="../../images/ds1_1.png" title="Body image" /></p>
<h2 id="ollama-deepseek">部署Ollama+ DeepSeek详细步骤：</h2>
<p>为 Ollama 创建一个专用命名空间。</p>
<pre><code>kubectl creat ns ollama
</code></pre>
<pre><code>kubectl get ns | grep ollama
ollama            Active   22h
</code></pre>
<p>创建一个 <code>deploy.yaml</code> 文件，定义 Ollama 的部署和模型的加载逻辑：</p>
<pre><code>
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ollama
  namespace: ollama
  labels:
    app: ollama
spec:
  replicas: 1
  selector:
    matchLabels:
      app: ollama
  template:
    metadata:
      labels:
        app: ollama
    spec:
      containers:
        - image: ollama/ollama:latest
          imagePullPolicy: IfNotPresent
          name: ollama
          ports:
            - containerPort: 11434
              protocol: TCP
        - name: load-model
          image: curlimages/curl
          imagePullPolicy: IfNotPresent
          args:
            - sleep infinity
          command:
            - /bin/sh
            - '-c'
          lifecycle:
            postStart:
              exec:
                command:
                  - /bin/sh
                  - '-c'
                  - &gt;
                    curl -X POST http://localhost:11434/api/pull -H
                    'Content-Type: application/json' -d '{&quot;name&quot;: &quot;llama3.2&quot;}'
          resources:
            limits:
              cpu: 25m
              memory: 50Mi
            requests:
              cpu: 25m
              memory: 50Mi
</code></pre>
<pre><code>kubectl apply -f deploy.yaml

% kubectl get pod -n ollama
NAME                      READY   STATUS    RESTARTS      AGE
ollama-79ffc59d74-rjd8l   2/2     Running   2 (21h ago)   22h
</code></pre>
<h3 id="ollama-api">暴露 Ollama API 服务</h3>
<p>为了与 Ollama 的 REST API 交互，我们需要将服务暴露出来。可以选择使用 LoadBalancer、NodePort 或 ClusterIP 类型的服务。</p>
<p>以下是一个示例服务配置文件 service.yaml</p>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: ollama
  namespace: ollama
  labels:
    app: ollama
spec:
  type: LoadBalancer
  ports:
  - port: 11434
    targetPort: 11434
    protocol: TCP
    name: http
  selector:
    app: ollama
</code></pre>
<p>与 Ollama + Deepseek 交互：</p>
<pre><code>% kubectl get svc -n ollama 
NAME     TYPE           CLUSTER-IP        EXTERNAL-IP    PORT(S)           AGE
ollama   LoadBalancer   192.168.194.211   198.19.249.2   11434:30330/TCP   22h
</code></pre>
<h3 id="ollama-deepseek_1">与 Ollama + Deepseek 交互：</h3>
<p>一旦 Ollama 部署完成，我们可以通过其 REST API 与模型交互。在之前的部署中，我们添加了load-model容器，用来与 Ollama 的API接口交互调用，我们进入容器内部，使用curl相关命令即可。'</p>
<p>a) 列出可用模型</p>
<p><strong>使用 GET 请求检索 Ollama 环境中所有可用模型的列表：</strong></p>
<pre><code>% curl http://localhost:11434/api/tags | jq

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   344  100   344    0     0  11075      0 --:--:-- --:--:-- --:--:-- 11096
{
  &quot;models&quot;: [
    {
      &quot;name&quot;: &quot;llama3.2:latest&quot;,
      &quot;model&quot;: &quot;llama3.2:latest&quot;,
      &quot;modified_at&quot;: &quot;2025-02-07T14:01:25.492244029Z&quot;,
      &quot;size&quot;: 2019393189,
      &quot;digest&quot;: &quot;a80c4f17acd55265feec403c7aef86be0c25983ab279d83f3bcd3abbcb5b8b72&quot;,
      &quot;details&quot;: {
        &quot;parent_model&quot;: &quot;&quot;,
        &quot;format&quot;: &quot;gguf&quot;,
        &quot;family&quot;: &quot;llama&quot;,
        &quot;families&quot;: [
          &quot;llama&quot;
        ],
        &quot;parameter_size&quot;: &quot;3.2B&quot;,
        &quot;quantization_level&quot;: &quot;Q4_K_M&quot;
      }
    }
  ]
}
</code></pre>
<p>要下载并加载特定模型（例如，deepseek-r1:8b），发送 POST 请求到 <code>/api/pull</code>：</p>
<pre><code>curl -X POST http://localhost:11434/api/pull \
     -H 'Content-Type: application/json' \
     -d '{
           &quot;name&quot;: &quot;deepseek-r1:1.5b&quot;
         }'
</code></pre>
<pre><code>{&quot;status&quot;:&quot;verifying sha256 digest&quot;}
{&quot;status&quot;:&quot;writing manifest&quot;}
{&quot;status&quot;:&quot;success&quot;}
</code></pre>
<p>c) 使用DeepSeek模型</p>
<p>加载模型后，可以通过 /api/generate 接口与模型交互：</p>
<pre><code>curl -X POST http://localhost:11434/api/generate \
     -H 'Content-Type: application/json' \
     -d '{
           &quot;model&quot;: &quot;deepseek-r1:1.5b&quot;,
           &quot;prompt&quot;: &quot;In exactly 10 words or less, explain why the sea is blue.&quot;,
           &quot;stream&quot;: false
         }'

</code></pre>
<pre><code>% curl http://localhost:11434/api/tags | jq     
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   678  100   678    0     0  79428      0 --:--:-- --:--:-- --:--:-- 84750
{
  &quot;models&quot;: [
    {
      &quot;name&quot;: &quot;deepseek-r1:1.5b&quot;,
      &quot;model&quot;: &quot;deepseek-r1:1.5b&quot;,
      &quot;modified_at&quot;: &quot;2025-02-07T15:21:52.361481421Z&quot;,
      &quot;size&quot;: 1117322599,
      &quot;digest&quot;: &quot;a42b25d8c10a841bd24724309898ae851466696a7d7f3a0a408b895538ccbc96&quot;,
      &quot;details&quot;: {
        &quot;parent_model&quot;: &quot;&quot;,
        &quot;format&quot;: &quot;gguf&quot;,
        &quot;family&quot;: &quot;qwen2&quot;,
        &quot;families&quot;: [
          &quot;qwen2&quot;
        ],
        &quot;parameter_size&quot;: &quot;1.8B&quot;,
        &quot;quantization_level&quot;: &quot;Q4_K_M&quot;
      }
    },
    {
      &quot;name&quot;: &quot;llama3.2:latest&quot;,
      &quot;model&quot;: &quot;llama3.2:latest&quot;,
      &quot;modified_at&quot;: &quot;2025-02-07T15:13:43.144599582Z&quot;,
      &quot;size&quot;: 2019393189,
      &quot;digest&quot;: &quot;a80c4f17acd55265feec403c7aef86be0c25983ab279d83f3bcd3abbcb5b8b72&quot;,
      &quot;details&quot;: {
        &quot;parent_model&quot;: &quot;&quot;,
        &quot;format&quot;: &quot;gguf&quot;,
        &quot;family&quot;: &quot;llama&quot;,
        &quot;families&quot;: [
          &quot;llama&quot;
        ],
        &quot;parameter_size&quot;: &quot;3.2B&quot;,
        &quot;quantization_level&quot;: &quot;Q4_K_M&quot;
      }
    }
  ]
}
</code></pre>
<p>示例返回结果：</p>
<p><img alt="Alt Image Text" src="../../images/ds1_2.png" title="Body image" /></p>
<pre><code>% curl -X POST http://localhost:11434/api/generate \
     -H 'Content-Type: application/json' \
     -d '{
           &quot;model&quot;: &quot;deepseek-r1:1.5b&quot;,
           &quot;prompt&quot;: &quot;In exactly 10 words or less, explain why the sea is blue.&quot;,
           &quot;stream&quot;: false
         }'
{&quot;model&quot;:&quot;deepseek-r1:1.5b&quot;,&quot;created_at&quot;:&quot;2025-02-07T15:22:43.334125705Z&quot;,&quot;response&quot;:&quot;\u003cthink\u003e\nOkay, so I'm trying to figure out why the sea is blue. From what I know, it's because of Rayleigh scattering, right? The sun emits a lot of light in all directions, but water molecules scatter some of that light when it hits them. Since blue light has shorter wavelengths, they're scattered more by the water molecules than red or other colors. That makes sense because the Sun is bright, so more light gets scattered.\n\nBut wait, I'm not entirely sure about all the details. Maybe there's something else causing the sea to be blue too. Like, do clouds affect it? I think when it's cloudy, you can see more of the sky, which might look blue because of the water's reflection or something. But does that make the entire sea appear blue?\n\nI'm also wondering about light diffusing in water. Does the light spread out so much that each part doesn't really catch up with the blue color? Maybe it just looks blue overall because of how the sky is colored.\n\nHmm, I think Rayleigh scattering is definitely a main reason for the sea being blue. But clouds might add more color to the sky or water. So putting it all together, the sea appears blue mainly due to Rayleigh scattering of sunlight by the water molecules, even though clouds can reflect some light that contributes to its color.\n\nI'm not sure if there are other factors, but I think Rayleigh scattering is the key here. Maybe with more particles in the air and more sunlight, it's easier for shorter wavelengths to scatter. So sea being blue is mostly about this phenomenon.\n\u003c/think\u003e\n\nThe sea appears blue primarily due to Rayleigh scattering of sunlight by water molecules. This occurs because shorter wavelengths (like blue) are scattered more effectively than longer ones (like red). Clouds can reflect some light contributing to the sky's color, but the main reason the sea appears blue is Rayleigh scattering, which is enhanced by factors such as a larger volume of water and more sunlight intensity.&quot;,&quot;done&quot;:true,&quot;done_reason&quot;:&quot;stop&quot;,&quot;context&quot;:[151644,641,6896,220,16,15,4244,476,2686,11,10339,3170,279,9396,374,6303,13,151645,151648,198,32313,11,773,358,2776,4460,311,7071,700,3170,279,9396,374,6303,13,5542,1128,358,1414,11,432,594,1576,315,13255,62969,71816,11,1290,30,576,7015,72780,264,2696,315,3100,304,678,17961,11,714,3015,34615,44477,1045,315,429,3100,979,432,12983,1105,13,8704,6303,3100,702,23327,92859,11,807,2299,36967,803,553,279,3015,34615,1091,2518,476,1008,7987,13,2938,3643,5530,1576,279,8059,374,9906,11,773,803,3100,5221,36967,382,3983,3783,11,358,2776,537,11368,2704,911,678,279,3565,13,10696,1052,594,2494,770,14381,279,9396,311,387,6303,2238,13,8909,11,653,29514,7802,432,30,358,1744,979,432,594,73549,11,498,646,1490,803,315,279,12884,11,892,2578,1401,6303,1576,315,279,3015,594,21844,476,2494,13,1988,1558,429,1281,279,4453,9396,4994,6303,1939,40,2776,1083,20293,911,3100,3638,970,304,3015,13,12553,279,3100,8865,700,773,1753,429,1817,949,3171,944,2167,2287,705,448,279,6303,1894,30,10696,432,1101,5868,6303,8084,1576,315,1246,279,12884,374,27197,382,80022,11,358,1744,13255,62969,71816,374,8491,264,1887,2874,369,279,9396,1660,6303,13,1988,29514,2578,912,803,1894,311,279,12884,476,3015,13,2055,10687,432,678,3786,11,279,9396,7952,6303,14576,4152,311,13255,62969,71816,315,39020,553,279,3015,34615,11,1496,3498,29514,646,8708,1045,3100,429,42972,311,1181,1894,382,40,2776,537,2704,421,1052,525,1008,9363,11,714,358,1744,13255,62969,71816,374,279,1376,1588,13,10696,448,803,18730,304,279,3720,323,803,39020,11,432,594,8661,369,23327,92859,311,44477,13,2055,9396,1660,6303,374,10008,911,419,24844,624,151649,271,785,9396,7952,6303,15503,4152,311,13255,62969,71816,315,39020,553,3015,34615,13,1096,13666,1576,23327,92859,320,4803,6303,8,525,36967,803,13444,1091,5021,6174,320,4803,2518,568,14817,82,646,8708,1045,3100,28720,311,279,12884,594,1894,11,714,279,1887,2874,279,9396,7952,6303,374,13255,62969,71816,11,892,374,23922,553,9363,1741,438,264,8131,8123,315,3015,323,803,39020,20612,13],&quot;total_duration&quot;:17627171188,&quot;load_duration&quot;:1094249415,&quot;prompt_eval_count&quot;:19,&quot;prompt_eval_duration&quot;:497000000,&quot;eval_count&quot;:407,&quot;eval_duration&quot;:16034000000}%  
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-9999 Jacob Xi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>